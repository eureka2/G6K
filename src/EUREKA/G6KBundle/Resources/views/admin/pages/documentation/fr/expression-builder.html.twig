<header class="jumbotron subhead" id="overview">
	<div class="container">
		<h1>
			G6K: Guide d'administration
		</h1>
		<p class="lead">Composition des expressions</p>
	</div>
</header>
<div class="container">
	<div class="row">
		<div class="span3 bs-docs-sidebar">
			<ul class="nav nav-list bs-docs-sidenav" data-spy="affix">
				<li data-level="1"><a href="#expressions">Expressions</a></li>
				<li data-level="2"><a href="#composition-d-une-expression">Composition d'une expression</a></li>
				<li data-level="3"><a href="#operandes">Opérandes</a></li>
				<li data-level="4"><a href="#divers">Divers</a></li>
				<li data-level="4"><a href="#champs">Champs</a></li>
				<li data-level="4"><a href="#constantes">Constantes</a></li>
				<li data-level="4"><a href="#fonctions">Fonctions</a></li>
				<li data-level="3"><a href="#operateurs">Opérateurs</a></li>
				<li data-level="2"><a href="#exemple-d-expression">Exemple d'expression</a></li>
			</ul>
		</div>
		<div class="span9">
			<h1 id="expressions">
				Expressions
			</h1>
			<p>Les expressions sont des formules mathématiques évaluées par G6K pour réaliser une simulation.</p>
			<p>Une expression est une combinaison d'opérandes et d'opérateurs.</p>
			<pre class="prettyprint">
&lt;expression&gt; : &lt;opérande&gt;[&lt;opérateur&gt;&lt;opérande&gt;]
&lt;opérande&gt; : &lt;expression&gt;|&lt;opérande&gt;
</pre>
			<p>G6K dispose d'un composant permettant de saisir des expressions.</p>
			<p>Ce composant est utilisé :</p>
			<ul>
				<li>dans la constitution des filtres des requêtes d'accès aux sources de données de référence</li>
				<li>pour calculer la valeur par défaut, la valeur minimale, la valeur maximale ou le contenu d'une donnée</li>
				<li>dans la constitution des conditions des règles métier</li>
			</ul>
			<h2 id="composition-d-une-expression">
				Composition d'une expression
			</h2>
			<p>
				Pour composer une expression, cliquez sur la boite à liste 
				<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/expression-builder-operand-select.png') }}" alt="" />
			</p>
			<p>Vous pouvez ainsi sélectionner les éléments constitutifs d'un opérande :</p>
			<ul>
				<li>valeur littérale</li>
				<li>constante</li>
				<li>donnée (champ)</li>
				<li>fonction</li>
				<li>sous-expression</li>
			</ul>
			<p>
				<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/fr/expression-builder-operands1.png') }}" alt="" />
				<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/fr/expression-builder-operands2.png') }}" alt="" />
			</p>
			<p>Ces éléments sont décrits ci-après :</p>
			<h3 id="operandes">
				Opérandes
			</h3>
			<h4 id="divers">
				Divers
			</h4>
			<table class="table table-condensed table-striped table-bordered">
				<thead>
					<tr>
						<th>Nom</th>
						<th>Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Constante</td>
						<td>
							Permet de saisir une valeur littérale. Après sélection de cet élément, le champ de saisie apparait : 
							<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/fr/expression-builder-operand-constant-input.png') }}" alt="" />
							. Saisissez la valeur puis appuyez sur la touche « Entrée ». Le mot « Constante » est remplacé par la valeur saisie.
						</td>
					</tr>
					<tr>
						<td>Sous-expression</td>
						<td>
							Permet de mettre une partie de l'expression entre parenthèses. Après sélection de cet élément, la boite à liste s'entoure de parenthèses :
							<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/expression-builder-operand-subexpression-input.png') }}" alt="" />
						</td>
					</tr>
				</tbody>
			</table>
			<h4 id="champs">
				Champs
			</h4>
			<p>La liste des champs est constituée à partir des libellés des données que vous avez définis (panneau « Données »).</p>
			<p>Pour insérer un champ dans l'expression, sélectionnez le dans la liste.</p>
			<h4 id="constantes">
				Constantes
			</h4>
			<table class="table table-condensed table-striped table-bordered">
				<thead>
					<tr>
						<th>Nom</th>
						<th>Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>pi</td>
						<td>3,14159</td>
					</tr>
					<tr>
						<td>now</td>
						<td>Date du jour de la simulation</td>
					</tr>
					<tr>
						<td>today</td>
						<td>Alias de now</td>
					</tr>
					<tr>
						<td>true</td>
						<td>Booléen 'vrai'</td>
					</tr>
					<tr>
						<td>false</td>
						<td>Booléen 'faux'</td>
					</tr>
				</tbody>
			</table>
			<h4 id="fonctions">
				Fonctions
			</h4>
			<table class="table table-condensed table-striped table-bordered">
				<thead>
					<tr>
						<th>Fonction</th>
						<th>Description</th>
						<th align="center">Nombre d'arguments</th>
						<th>Type retourné</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>abs</td>
						<td>Renvoie la valeur absolue de l'argument numérique</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>acos</td>
						<td>Renvoie l'arc cosinus de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>acosh</td>
						<td>Renvoie l'arc cosinus hyperbolique de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>addMonths</td>
						<td>Ajoute le nombre de mois en argument 1 à la date en argument 2 et retourne la date résultat</td>
						<td align="center">2</td>
						<td>date</td>
					</tr>
					<tr>
						<td>asin</td>
						<td>Renvoie l'arc sinus de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>asinh</td>
						<td>Renvoie l'arc sinus hyperbolique de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>atan</td>
						<td>Renvoie l'arc tangente de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>atan2</td>
						<td>Renvoie l'arc tangente 2 de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>atanh</td>
						<td>Renvoie l'arc tangente hyperbolique de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>ceil</td>
						<td>Renvoie la plus petite valeur entière supérieure ou égale à la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>cos</td>
						<td>Renvoie le cosinus de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>cos</td>
						<td>Renvoie le cosinus de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>count</td>
						<td>Retourne le nombre d'arguments non nul</td>
						<td align="center">illimité</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>day</td>
						<td>Retourne le jour (1 à 31) extrait de la date fournie en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>exp</td>
						<td>Renvoie l'exponentiel de la valeur passée en argument, c-à-d la valeur de e portée à la puissance de l'argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>firstDayOfMonth</td>
						<td>Renvoie la date correspondant au premier jour du mois, calculé à partir de la date fournie en argument</td>
						<td align="center">1</td>
						<td>date</td>
					</tr>
					<tr>
						<td>floor</td>
						<td>Renvoie la plus grande valeur entière inférieure ou égale à la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>fullmonth</td>
						<td>Renvoie le libellé en clair du mois extrait de la date fournie en argument</td>
						<td align="center">1</td>
						<td></td>
					</tr>
					<tr>
						<td>get</td>
						<td>Retourne l'élément de la liste en argument 1 en position fournie en argument 2</td>
						<td align="center">2</td>
						<td>texte</td>
					</tr>
					<tr>
						<td>lastday</td>
						<td>Retourne le dernier jour du mois (1 à 31) calculé à partir du mois (1 à 12) en argument 1 et de l'année en argument 2</td>
						<td align="center">2</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>lastDayOfMonth</td>
						<td>Renvoie la date correspondant au dernier jour du mois, calculé à partir de la date fournie en argument</td>
						<td align="center">1</td>
						<td>date</td>
					</tr>
					<tr>
						<td>length</td>
						<td>Renvoie la longueur de la chaîne passée en argument</td>
						<td align="center">1</td>
						<td>entier</td>
					</tr>
					<tr>
						<td>log</td>
						<td>Renvoie le logarithme de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>log10</td>
						<td>Renvoie le logarithme base 10 de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>lower</td>
						<td>Convertit la chaîne en lettres minuscules</td>
						<td align="center">1</td>
						<td>texte</td>
					</tr>
					<tr>
						<td>match</td>
						<td>Retourne vrai si le texte en argument 2 correspond à l'expression régulière en argument 1, faux sinon</td>
						<td align="center">2</td>
						<td>booléen</td>
					</tr>
					<tr>
						<td>max</td>
						<td>Renvoie la plus grande des valeurs fournies en arguments</td>
						<td align="center">illimité</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>min</td>
						<td>Renvoie la plus petite des valeurs fournies en arguments</td>
						<td align="center">illimité</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>money</td>
						<td>Convertit le montant fourni en argument en chaîne de caractères</td>
						<td align="center">1</td>
						<td>texte</td>
					</tr>
					<tr>
						<td>month</td>
						<td>Retourne le mois (1 à 12) extrait de la date fournie en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>nextWorkDay</td>
						<td>Retourne le jour ouvrable (tenant compte des jours fériés) suivant la date fournie en argument</td>
						<td align="center">1</td>
						<td>date</td>
					</tr>
					<tr>
						<td>pow</td>
						<td>Renvoie la valeur de l'argument 1 élevé à la puissance de la valeur de l'argument 2</td>
						<td align="center">2</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>rand</td>
						<td>Retourne une valeur aléatoire comprise entre 0 et 1 inclus avec l'argument comme valeur de départ</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>replace</td>
						<td>Remplace toutes les occurrences de l'argument 1 dans l'argument 3 par la valeur de l'argument 2</td>
						<td align="center">3</td>
						<td>texte</td>
					</tr>
					<tr>
						<td>round</td>
						<td>Arrondit la valeur de l'argument 1 à la valeur la plus proche avec le nombre de décimal passé en argument 2</td>
						<td align="center">2</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>sin</td>
						<td>Renvoie le sinus de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>sinh</td>
						<td>Renvoie le sinus hyperbolique de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>size</td>
						<td>Retourne le nombre d'éléments de la liste fournie e argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>split</td>
						<td>Transforme la chaine fournie en argument 2 en une liste selon l'expression régulière en argument 1</td>
						<td align="center">2</td>
						<td>liste</td>
					</tr>
					<tr>
						<td>sqrt</td>
						<td>Renvoie la racine carrée de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>sum</td>
						<td>Retourne la somme des arguments</td>
						<td align="center">illimité</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>tan</td>
						<td>Renvoie la tangente de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>tanh</td>
						<td>Renvoie la tangente hyperbolique de la valeur passée en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>upper</td>
						<td>Convertit la chaîne en lettres majuscules</td>
						<td align="center">1</td>
						<td>texte</td>
					</tr>
					<tr>
						<td>workdays</td>
						<td>Retourne le nombre de jours ouvrables (tenant compte des jours fériés) entre les deux dates fournies en arguments.</td>
						<td align="center">2</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>workdaysofmonth</td>
						<td>Retourne le nombre de jours ouvrables (tenant compte des jours fériés) du mois calculé à partir du mois (1 à 12) en argument 2 et de l'année en argument 1</td>
						<td align="center">2</td>
						<td>nombre</td>
					</tr>
					<tr>
						<td>year</td>
						<td>Retourne l'année extraite de la date fournie en argument</td>
						<td align="center">1</td>
						<td>nombre</td>
					</tr>
				</tbody>
			</table>
			<p>Après sélection de la fonction, une boite à liste par argument s'affiche, vous permettant de saisir les arguments de la fonction. Ces arguments sont aussi des expressions.</p>
			<p>
				Une fois terminée la saisie de l'opérande, celui-ci s'affiche souligné.
				<br />
				Ainsi sont soulignés, les noms d'éléments et les parenthèses ouvrantes.
			</p>
			<p>
				Cet opérande peut suffire pour constituer une expression mais vous pouvez le combiner avec d'autres opérandes pour composer une expression plus "complexe".
				<br />
				Pour ce faire, clic-droit sur un élément souligné et le menu suivant s'affiche :
			</p>
			<p>
				<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/fr/expression-builder-contextmenu.png') }}" alt="" />
			</p>
			<table class="table table-condensed table-striped table-bordered">
				<thead>
					<tr>
						<th>Elément du menu</th>
						<th>Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>Changer cet opérande</td>
						<td>
							Remplace l'élément souligné par une boite à liste : 
							<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/fr/expression-builder-menu-change.png') }}" alt="" />
							vous permettant de remplacer l'opérande.
						</td>
					</tr>
					<tr>
						<td>Ajouter un opérande après celui-ci</td>
						<td>
							Ajoute une boite à liste d'opérateurs 
							<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/fr/expression-builder-menu-insert-after.png') }}" alt="" />
							après l'élément souligné vous permettant de sélectionner l'opérateur qui combinera les deux opérandes.
							<br>
							Une fois l'opérateur choisi, une boite à liste s'affiche pour le deuxième opérande. 
							<br>
							Les opérateurs sont définis dans le paragraphe suivant.
						</td>
					</tr>
					<tr>
						<td>Ajouter un opérande avant celui-ci</td>
						<td>
							Ajoute une boîte à liste d'opérandes pour le deuxième opérande ainsi qu'une boite à liste d'opérateurs pour combiner les deux opérandes 
							<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/fr/expression-builder-menu-insert-before.png') }}" alt="" />
							avant l'élément souligné. 
							<br>
							Les opérateurs sont définis dans le paragraphe suivant.
						</td>
					</tr>
					<tr>
						<td>Changer en une sous-expression entre parenthèses</td>
						<td>
							Remplace l'élément souligné par une boite à liste entourée de parenthèse :
							<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/expression-builder-operand-subexpression-input.png') }}" alt="" />
						</td>
					</tr>
					<tr>
						<td>Supprimer cet opérande</td>
						<td>Supprime l'opérande souligné.</td>
					</tr>
				</tbody>
			</table>
			<h3 id="operateurs">
				Opérateurs
			</h3>
			<p>
				<img src="{{ asset('bundles/eurekag6k/admin/images/documentation/expression-builder-operators.png') }}" alt="" />
			</p>
			<table class="table table-condensed table-striped table-bordered">
				<thead>
					<tr>
						<th align="center">Symbole</th>
						<th>Description</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td align="center">+</td>
						<td>Addition</td>
					</tr>
					<tr>
						<td align="center">-</td>
						<td>Soustraction</td>
					</tr>
					<tr>
						<td align="center">*</td>
						<td>Multiplication</td>
					</tr>
					<tr>
						<td align="center">/</td>
						<td>Division</td>
					</tr>
					<tr>
						<td align="center">%</td>
						<td>Reste de la division entière</td>
					</tr>
					<tr>
						<td align="center">&amp;</td>
						<td>Opérateur bit à bit 'AND'</td>
					</tr>
					<tr>
						<td align="center">&#124;</td>
						<td>Opérateur bit à bit 'OR'</td>
					</tr>
				</tbody>
			</table>
			<h2 id="exemple-d-expression">
				Exemple d'expression
			</h2>
			<p>Dans le simulateur de démo fourni avec G6K pour le calcul d'une pension alimentaire, la donnée « Montant par enfant » est calculée avec l'expression suivante :</p>
			<p><code>max(0, round((Revenus du débiteur - Montant forfaitaire du RSA) * Taux pension alimentaire / 100))</code></p>
			<p>Dans cette expression « Revenus du débiteur », « Montant forfaitaire du RSA » et « Taux pension alimentaire » sont des champs (données), « max » et « round » sont des fonctions, « 0 » et « 100 » sont des constantes, « - », « * » et « / » sont des opérateurs.</p>
		</div>
	</div>
</div>
